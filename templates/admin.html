<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - Rachel's Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <style>
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        body {
            font-family: 'Nunito Sans', sans-serif;
            background: linear-gradient(-45deg, #FDF8F5, #F5EBE0, #EAD7D7, #FDF8F5);
            background-size: 400% 400%;
            animation: gradient-animation 15s ease infinite;
            color: #5C4B4B;
        }
        .font-display { font-family: 'Playfair Display', serif; }
        .bg-blush-dark { background-color: #D5B4B4; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">

    <div class="w-full max-w-md p-8 space-y-8 bg-white/60 backdrop-blur-sm shadow-xl rounded-2xl border border-gray-200/50">
        <div>
            <h1 class="text-3xl font-bold text-center text-gray-800 font-display">Admin Panel</h1>
            <p class="mt-2 text-center text-sm text-gray-600">Please sign in to continue</p>
        </div>
        
        <div id="auth-container">
            <button id="google-signin-btn" class="w-full flex items-center justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-800 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-300 transition-colors">
                <svg class="w-5 h-5 mr-3" aria-hidden="true" focusable="false" role="img" viewBox="0 0 48 48">
                    <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24 s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path>
                    <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657 C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path>
                    <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path>
                    <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238 C42.022,35.17,44,30.023,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path>
                </svg>
                Sign in with Google
            </button>
        </div>

        <p id="error-message" class="text-center text-sm text-red-600"></p>
    </div>

    <script>
        // --- Firebase Configuration ---
        // IMPORTANT: Replace the placeholder values below with your actual Firebase config
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const provider = new firebase.auth.GoogleAuthProvider();
        
        // --- Event Listeners ---
        const googleSignInButton = document.getElementById('google-signin-btn');
        const errorMessage = document.getElementById('error-message');

        googleSignInButton.addEventListener('click', () => {
            errorMessage.textContent = ''; // Clear previous errors
            auth.signInWithPopup(provider)
                .then((result) => {
                    // This gives you a Google Access Token. You can use it to access the Google API.
                    const credential = result.credential;
                    const token = credential.accessToken;
                    // The signed-in user info.
                    const user = result.user;

                    // Send the ID token to your backend
                    return user.getIdToken();
                })
                .then(idToken => {
                    return fetch('/set-session', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ idToken: idToken })
                    });
                })
                .then(response => {
                    if (response.ok) {
                        // Redirect to the admin panel on successful session creation
                        window.location.href = '/admin';
                    } else {
                        throw new Error('Failed to set session on the server.');
                    }
                })
                .catch((error) => {
                    // Handle Errors here.
                    console.error("Authentication Error:", error);
                    errorMessage.textContent = error.message || "An error occurred during sign-in.";
                });
        });
    </script>
</body>
</html>